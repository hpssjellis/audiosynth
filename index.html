<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>abcjs demo</title>

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
	<link href="abcjs-midi.css" media="all" rel="stylesheet" type="text/css" />
	<script src="abcjs_editor_midi_3.1.1-min.js" type="text/javascript"></script>
	<style>
		.abcjs-inline-midi {
			max-width: 740px;
		}
	</style>

<title>Sheet Music Socket </title>






<script src="Tone.min.js"></script>




<script>

var synth  = new Tone.Synth().toMaster();

   //synth = Synth.createInstrument('synth'); // play with your synth guitar!
  // piano = Synth.createInstrument('piano'); // play with your synth guitar!
   //organ = Synth.createInstrument('organ'); // play with your synth guitar!
  // edm = Synth.createInstrument('edm'); // play with your synth guitar!

    
    
</script>


<input id="myIOS" type=button value="iOS Start" onclick="{
var synth = new Tone.Synth().toMaster();

//play a middle 'C' for the duration of an 8th note
synth.triggerAttackRelease('C4', '8n');

}">
<!--
<input type=button value="synth.triggerAttackRelease('C4', '8n')" onclick="{
synth.triggerAttackRelease('C4', '8n');
}"><br>
<input type=button value="synth.triggerAttackRelease('C#4', 0.5)" onclick="{
 synth.triggerAttackRelease('C#4', 0.2);
}"><br>


<input type=button value="synth.triggerAttackRelease('C', 4, 6)" onclick="{
 synth.triggerAttackRelease('C', 4, 6);
}"><br>

<input type=button value="synth.triggerAttackRelease('C', 4, 12)" onclick="{
 synth.triggerAttackRelease('C', 4, 12);
}"><br>




<input type=button value="piano.triggerAttackRelease('C', 4, 2)" onclick="{

 piano.triggerAttackRelease('C', 4, 2);

}"><br>







<input type=button value="organ.triggerAttackRelease('C', 4, 2)" onclick="{

 organ.triggerAttackRelease('C', 4, 2);

}"><br>







<input type=button value="edm.triggerAttackRelease('C', 4, 2)" onclick="{

 edm.triggerAttackRelease('C', 4, 2);

}"><br><br>



-->

<h2 aligne=center>MusicChat use your keypad2</h2>

<input type=button value="C4" onClick="{wssend('A'); }">
<input type=button value="#C4" onclick="{wssend('S')}">
<input type=button value="D4" onclick="{wssend('D')}">
<input type=button value="D#4" onclick="{wssend('F')}">
<input type=button value="E4" onclick="{wssend('D')}">
<input type=button value="F4" onclick="{wssend('F')}">
<input type=button value="F#4" onclick="{wssend('G')}">
<input type=button value="G4" onclick="{wssend('H')}">
<input type=button value="G#4" onclick="{wssend('J')}">
<input type=button value="A5" onclick="{wssend('L')}">
<input type=button value="A#5" onclick="{wssend(';')}">
<input type=button value="B5" onclick="{wssend(';')}">    
<input type=button value="C5" onclick="{wssend('Q')}">

<br>

no keyboard ability to play 
<input type=button value="A#3" onclick="{wssend('a')}">
<br>


</head>

<body  onKeyDown = "{


   	if(String.fromCharCode(event.keyCode) == 'A'){ wssend('A')  }  
   	if(String.fromCharCode(event.keyCode) == 'B'){ wssend('B')  }  
   	if(String.fromCharCode(event.keyCode) == 'C'){ wssend('C')  }  
   	if(String.fromCharCode(event.keyCode) == 'D'){ wssend('D')  }  
   	if(String.fromCharCode(event.keyCode) == 'E'){ wssend('E')  }  
   	if(String.fromCharCode(event.keyCode) == 'F'){ wssend('F')  }  
   	if(String.fromCharCode(event.keyCode) == 'G'){ wssend('G')  }  
   	if(String.fromCharCode(event.keyCode) == 'H'){ wssend('H')  }  
   	if(String.fromCharCode(event.keyCode) == 'I'){ wssend('I')  }  
   	if(String.fromCharCode(event.keyCode) == 'J'){ wssend('J')  }  
   	if(String.fromCharCode(event.keyCode) == 'K'){ wssend('K')  }  
   	if(String.fromCharCode(event.keyCode) == 'L'){ wssend('L')  }  
   	if(String.fromCharCode(event.keyCode) == 'M'){ wssend('M')  }  
   	if(String.fromCharCode(event.keyCode) == 'N'){ wssend('N')  }  
   	if(String.fromCharCode(event.keyCode) == 'O'){ wssend('O')  }  
   	if(String.fromCharCode(event.keyCode) == 'P'){ wssend('P')  }  
   	if(String.fromCharCode(event.keyCode) == 'Q'){ wssend('Q')  }  
   	if(String.fromCharCode(event.keyCode) == 'R'){ wssend('R')  }  
   	if(String.fromCharCode(event.keyCode) == 'S'){ wssend('S')  }  
   	if(String.fromCharCode(event.keyCode) == 'T'){ wssend('T')  }  
   	if(String.fromCharCode(event.keyCode) == 'U'){ wssend('U')  }  
   	if(String.fromCharCode(event.keyCode) == 'V'){ wssend('V')  }  
   	if(String.fromCharCode(event.keyCode) == 'W'){ wssend('W')  }  
   	if(String.fromCharCode(event.keyCode) == 'X'){ wssend('X')  }  
   	if(String.fromCharCode(event.keyCode) == 'Y'){ wssend('Y')  }  
   	if(String.fromCharCode(event.keyCode) == 'Z'){ wssend('Z')  } 
   	if(String.fromCharCode(event.keyCode) == 'À'){ wssend('À')  }    //    `
   
   	if(String.fromCharCode(event.keyCode) == '1'){ wssend('1')  }  
   	if(String.fromCharCode(event.keyCode) == '2'){ wssend('2')  }  
   	if(String.fromCharCode(event.keyCode) == '3'){ wssend('3')  }  
   	if(String.fromCharCode(event.keyCode) == '4'){ wssend('4')  }  
   	if(String.fromCharCode(event.keyCode) == '5'){ wssend('5')  }  
   	if(String.fromCharCode(event.keyCode) == '6'){ wssend('6')  }  
   	if(String.fromCharCode(event.keyCode) == '7'){ wssend('7')  }  
   	if(String.fromCharCode(event.keyCode) == '8'){ wssend('8')  }  
   	if(String.fromCharCode(event.keyCode) == '9'){ wssend('9')  }  
   	if(String.fromCharCode(event.keyCode) == '0'){ wssend('0')  }
  	if(String.fromCharCode(event.keyCode) == '½'){ wssend('½')  }     //   -
  	if(String.fromCharCode(event.keyCode) == '»'){ wssend('»')  }     //   =
   	if(String.fromCharCode(event.keyCode) == ' '){ wssend(' ')  }    
  
  
   	if(String.fromCharCode(event.keyCode) == '¿'){ wssend('¿')  }     //  /  /
   	if(String.fromCharCode(event.keyCode) == 'Ü'){ wssend('Ü')  }     //   \ 
   	if(String.fromCharCode(event.keyCode) == '¼'){ wssend('¼')  }     //   ,
   	if(String.fromCharCode(event.keyCode) == 'Û'){ wssend('Û')  }     //   [
   	if(String.fromCharCode(event.keyCode) == 'Ý'){ wssend('Ý')  }     //   ] 
   	if(String.fromCharCode(event.keyCode) == '¾'){ wssend('¾')  }     // .
   	if(String.fromCharCode(event.keyCode) == 'Þ'){ wssend('Þ')   }     //  '
   	if(String.fromCharCode(event.keyCode) == 'º'){ wssend('º')  }     //  ;
   	if(String.fromCharCode(event.keyCode) == 'a'){ wssend('a')  }     //  ;
   	if(String.fromCharCode(event.keyCode) == 'b'){ wssend('b')  }     //  ;
   	
   	
 
}" onload="{
   document.getElementById('myIOS').click();
   document.getElementById('abc').focus()
      
}">

  







<input type=hidden id="mySend" value="">
<iframe style="display:none" width="400" height="200" name="myFrameName" id="myFrameId"></iframe> 





















<script>


function myTom(myin){
   this.data = myin
 
}

function wssend(myStuff){
   if (document.mySocial == true){
    ws.send(myStuff);
   } else {
     tom = new myTom(myStuff)
     myPrep(tom);  
       
   }
}

 document.mobileInput = false;
 document.mySocial = true
 document.myCounter = 0;
 document.myTime = new Date();
 document.myTimeOld = document.myTime.getTime()

function myPrep(event){
    
    
   

     if (event.data == 'Time is up refresh to stay'){document.body.style.backgroundColor = "red";}
 
 myNote = '|'
 
 
 myTime = new Date();
 mySeconds = myTime.getTime()
 myInterval = mySeconds - document.myTimeOld  // in milliseconds
 document.myTimeOld = mySeconds
 //alert(myInterval)
 //alert(mySeconds)
 
 if (myInterval > 100){ myDuration = 0.1;  noteLength = '/16 '; }
 if (myInterval > 200){ myDuration = 0.3;  noteLength = '/8 '; }
 if (myInterval > 300){ myDuration = 0.5;  noteLength = '/4 '; }
 if (myInterval > 500){ myDuration = 1;  noteLength = '/2 '; }
 if (myInterval > 1000){ myDuration = 6;  noteLength = ' '; }
 
    if (event.data == 'Z'){  synth.triggerAttackRelease('C3', myDuration);   myNote ='C,'+ noteLength; }
    if (event.data == 'X'){  synth.triggerAttackRelease('C#3', myDuration);  myNote ='^C,'+ noteLength;}
    if (event.data == 'C'){  synth.triggerAttackRelease('D3', myDuration);   myNote ='D,'+ noteLength;}
    if (event.data == 'V'){  synth.triggerAttackRelease('D#3', myDuration);  myNote ='^D,'+ noteLength;}
    if (event.data == 'B'){  synth.triggerAttackRelease('E3', myDuration);   myNote ='E,'+ noteLength;}
    if (event.data == 'N'){  synth.triggerAttackRelease('F3', myDuration);   myNote ='F,'+ noteLength;}
    if (event.data == 'M'){  synth.triggerAttackRelease('F#3', myDuration);  myNote ='^F,'+ noteLength;}
    if (event.data == '¼'){  synth.triggerAttackRelease('G3', myDuration);   myNote ='G,'+ noteLength;}  //  ,
    
    if (event.data == '¾'){  synth.triggerAttackRelease('G#3', myDuration);  myNote ='^G,'+ noteLength;}  //   .
    if (event.data == '¿'){  synth.triggerAttackRelease('A3', myDuration);   myNote ='A,'+ noteLength;}  //    /
    if (event.data == 'a'){  synth.triggerAttackRelease('A#3', myDuration);  myNote ='^A,'+ noteLength;}   //   a
    if (event.data == ' '){  synth.triggerAttackRelease('B3', myDuration);   myNote ='B,'+ noteLength;}
    
    
    if (event.data == 'A'){  synth.triggerAttackRelease('C4', myDuration);   myNote ='C'+ noteLength;}
    if (event.data == 'S'){  synth.triggerAttackRelease('C#4', myDuration);  myNote ='^C'+ noteLength;}
    if (event.data == 'D'){  synth.triggerAttackRelease('D4', myDuration);   myNote ='D'+ noteLength;}
    if (event.data == 'F'){  synth.triggerAttackRelease('D#4', myDuration);  myNote ='^D'+ noteLength;}
    if (event.data == 'G'){  synth.triggerAttackRelease('E4', myDuration);   myNote ='E'+ noteLength;}
    if (event.data == 'H'){  synth.triggerAttackRelease('F4', myDuration);   myNote ='F'+ noteLength;}
    if (event.data == 'J'){  synth.triggerAttackRelease('F#4', myDuration);  myNote ='^F'+ noteLength;}
    if (event.data == 'K'){  synth.triggerAttackRelease('G4', myDuration);   myNote ='G'+ noteLength;}
    if (event.data == 'L'){  synth.triggerAttackRelease('G#4', myDuration);  myNote ='^G'+ noteLength;}
    

    if (event.data == 'º'){  synth.triggerAttackRelease('A4', myDuration);   myNote ='A'+ noteLength;}     //    ;
    if (event.data == 'Þ'){  synth.triggerAttackRelease('A#4', myDuration);  myNote ='^A'+ noteLength;}    //    '
   //if (event.data == 'b'){  synth.triggerAttackRelease('B', 4, myDuration);  myNote ='B'+ noteLength;}   //    ---
    if (event.data == 'Ü'){  synth.triggerAttackRelease('B4', myDuration);   myNote ='B' + noteLength;}    // \  
    
    
    if (event.data == 'Q'){  synth.triggerAttackRelease('C5', myDuration);   myNote ='c'+ noteLength;}
    if (event.data == 'W'){  synth.triggerAttackRelease('C#5', myDuration);  myNote ='^c'+ noteLength;}
    if (event.data == 'E'){  synth.triggerAttackRelease('D5', myDuration);   myNote ='d'+ noteLength;}
    if (event.data == 'R'){  synth.triggerAttackRelease('D#5', myDuration);  myNote ='^d'+ noteLength;}
    if (event.data == 'T'){  synth.triggerAttackRelease('E5', myDuration);   myNote ='e'+ noteLength;}
    if (event.data == 'Y'){  synth.triggerAttackRelease('F5', myDuration);   myNote ='f'+ noteLength;}
    if (event.data == 'U'){  synth.triggerAttackRelease('F#5', myDuration);  myNote ='^f'+ noteLength;}
    if (event.data == 'I'){  synth.triggerAttackRelease('G5', myDuration);   myNote ='g'+ noteLength;}
    if (event.data == 'O'){  synth.triggerAttackRelease('G#5', myDuration);  myNote ='^g'+ noteLength;}
            
    if (event.data == 'P'){  synth.triggerAttackRelease('A5', myDuration);   myNote ='a'+ noteLength;}
    if (event.data == 'Û'){  synth.triggerAttackRelease('A#5', myDuration);  myNote ='^a'+ noteLength;}    // [
    if (event.data == 'Ý'){  synth.triggerAttackRelease('B5', myDuration);   myNote ='b'+ noteLength;}    // ]
    
    
    
    
    if (event.data == 'À'){  synth.triggerAttackRelease('C6', myDuration);  myNote ='c\''+ noteLength;}     //    `
    if (event.data == '1'){  synth.triggerAttackRelease('C#6', myDuration);  myNote ='^c\''+ noteLength;}
    if (event.data == '2'){  synth.triggerAttackRelease('D6', myDuration);  myNote ='d\''+ noteLength;}
    if (event.data == '3'){  synth.triggerAttackRelease('D#6', myDuration);  myNote ='^d\''+ noteLength;}
    if (event.data == '4'){  synth.triggerAttackRelease('E6', myDuration);  myNote ='e\''+ noteLength;}
    if (event.data == '5'){  synth.triggerAttackRelease('F6', myDuration);  myNote ='f\''+ noteLength;}
    if (event.data == '6'){  synth.triggerAttackRelease('F#6', myDuration);  myNote ='^f\''+ noteLength;}
    if (event.data == '7'){  synth.triggerAttackRelease('G6', myDuration);  myNote ='g\''+ noteLength;}
    if (event.data == '8'){  synth.triggerAttackRelease('G#6', myDuration);  myNote ='^g\''+ noteLength;}
    if (event.data == '9'){  synth.triggerAttackRelease('A6', myDuration);  myNote ='a\''+ noteLength;}
    if (event.data == '0'){  synth.triggerAttackRelease('A#6', myDuration);  myNote ='^a\''+ noteLength;}
    if (event.data == '½'){  synth.triggerAttackRelease('B6', myDuration);  myNote ='b\''+ noteLength;}   // -
    if (event.data == '»'){  synth.triggerAttackRelease('C7', myDuration);  myNote ='c\'\''+ noteLength;}   // =
   
   
   
   document.getElementById('myDiv1').innerHTML = 'Pressed = '+event.data + ', note = ' + myNote +'<br>'+document.getElementById('myDiv1').innerHTML; 
    //alert(event.data)
    
    //myNote = '|:D2|D2|D2|D2|'
    
    
    
    //if (myInterval ){myNote += 'z'}
    for (myLoop = 1; myLoop <= myInterval/1000; myLoop++){
       myNote += 'z'
       document.myCounter ++;
       if (document.myCounter % 4 == 0){myNote += '| '}
       if (document.myCounter % 20 == 0){myNote += ']\n'}
    }
    myNote += ' '
    
    document.myCounter ++;
    if (document.myCounter % 4 == 0){myNote += '| '}
    if (document.myCounter % 20 == 0){myNote += ']\n'}
    
    //  ]
    
   
   
    // alert(document.getElementById('myEdit').value)
   if (document.getElementById('myEdit').value == 'edit'){ 

       document.getElementById('abc').value += myNote
       if(document.mobileInput ==true){
       document.getElementById('abc').focus()
    }
   }
   
   
   
  
    //alert(event.data)
    
}




var host = location.origin.replace(/^http/, 'ws')
var ws = new WebSocket(host);
ws.onmessage = function (event) {
    if (document.mySocial == true){
        myPrep(event);
   }

    
};

 ws.onconnection = function (event) {
    ws.send('something');
}; 


</script>


   
   

   
    

<h1>Websocket Output Here</h1>
<input type=button value=Clear onclick="{

document.getElementById('abc').value ='X:1\nT:Notes\nM:C\nL:1/1\nK:C\n| ' 

}">
<input id="myEdit" type=button value=edit onclick="{
  //alert(document.getElementById('myEdit').value)
  if ( this.value =='edit'){
      
      document.getElementById('abc').readOnly = false
      document.getElementById('abc').style.backgroundColor = 'yellow'
      this.value ='play'
    } else { 
    
       document.getElementById('abc').style.backgroundColor = 'white'
       document.getElementById('abc').readOnly = true
       this.value ='edit'
    
    }
}">

<input type=button value="Solo" onclick="{

if (this.value == 'Solo'){
     document.mySocial = false 
     this.value = 'Social'
 } else {
   document.mySocial = true
   this.value = 'Solo'
 }
}">

<br><br>





<textarea name="abc" id="abc" cols="80" rows="15" READONLY onkeydown="{
  
}" >
X:1
T:Notes
M:C
L:1/1
K:C
| </textarea><br>


<input type=text value="Mobile Input use Firefox" onFocus="{
    this.value = ''
}" onBlur="{
      document.mobileInput = false;
}" onchange="{
   wssend(event)
   document.mobileInput = true;
}">



<hr />
<div id="midi"></div>
<div id="midi-download"></div>
<div id="warnings"></div>
<div id="music"></div>
<div id="paper0"></div>
<div id="paper1"></div>
<div id="paper2"></div>
<div id="paper3"></div>
<div id="selection"></div>

<script type="text/javascript">
	function selectionCallback(abcelem) {
		var note = {};
		for (var key in abcelem) {
			if (abcelem.hasOwnProperty(key) && key !== "abselem")
				note[key] = abcelem[key];
		}
		console.log(abcelem);
		var el = document.getElementById("selection");
		el.innerHTML = "<b>selectionCallback parameter:</b><br>" + JSON.stringify(note);
	}

	function initEditor() {
		new ABCJS.Editor("abc", { paper_id: "paper0",
			generate_midi: true,
			midi_id:"midi",
			midi_download_id: "midi-download",
			generate_warnings: true,
			warnings_id:"warnings",
			midi_options: {
				generateDownload: true
			},
			render_options: {
				listener: { highlight: selectionCallback }
			}
		});
	}

	window.addEventListener("load", initEditor, false);
</script>









<div id="myDiv2">  </div><br>
<div id="myDiv1">  </div><br>
  
   
    
    
    
    
    
    
<br><br>    
Use at your own risk, by Jeremy Ellis<br>

audiosynth by Keith Whol <a href="https://github.com/keithwhor/audiosynth">https://github.com/keithwhor/audiosynth</a>
abcjs by paul Rosen <a href="https://github.com/paulrosen/abcjs">https://github.com/paulrosen/abcjs</a>
Website: <a href="http://rocksetta.com/">http://rocksetta.com/</a><br>
Twitter: @rocksetta

</body>
</html>
